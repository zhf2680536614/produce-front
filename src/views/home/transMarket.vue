<!-- ‰∫§ÊòìÂ∏ÇÂú∫ -->
<template>
    <div>
        <home-top />

        <!-- ‰æßËæπÊ†è -->
        <div style="z-index:10;position:fixed;left:20px;top:230px;" class="aside">
            <button @click="scrollToDiv('top10')">ÂõûÂà∞È°∂ÈÉ®</button>
            <br>
            <br>
            <button @click="scrollToDiv('span2')">‰∫ßÂìÅÁßíÊùÄ</button>
            <br>
            <br>
            <button @click="scrollToDiv('span3')">‰∫ßÂìÅ‰∫§Êòì</button>
        </div>
        <hr style="width: 100%" class="hr">

        <!-- ÂàÜÁ±ªÈîÄÈáèÊéíÂêç -->
        <span id="top10">TOP10</span><br><br>
        <div id="main" style="width: 100%;height:500px;"></div>

        <!-- ‰∫ßÂìÅÁßíÊùÄ -->
        <hr style="width: 100%" class="hr">
        <span id="span2">‰∫ßÂìÅÁßíÊùÄ</span><br><br>
        <div>
            <el-card shadow="hover" style="width: 100%;">
                <span style="font-size:24px;">üéâüéâüéâüéâüéâÂïÜÂìÅÈôç‰ª∑üéâüéâüéâüéâüéâ</span><br><br>
                <div style="width: 100%; display: inline-block;">
                    <span style="font-size:22px;">Áâπ‰ª∑‰∫ßÂìÅÂÆûÊó∂Êõ¥Êñ∞,ÂÖ®Âú∫8Êäò,ÂºÄÂßãÊãºÊâãÈÄüÂêßÔºÅ</span><br><br>
                    <span style="font-size:24px;">Seconds:{{
                        secondsPlus1 }}</span>
                </div>
            </el-card>
        </div>

        <div style="position:relative; left:8px; top:20px;" class="producesPlus">
            <el-skeleton :loading="loading" animated :count="3">
                <template>
                    <el-card :body-style="{ padding: '0px', marginBottom: '1px' }" v-for="item in listsPlus"
                        :key="item.id" style="display:inline-block;margin:10px;width:340px;height:440px;">
                        <img :src="item.image" class="image multi-content" style="width:340px;height:340px;" />
                        <div style="padding: 14px;">
                            <span style="position:relative;left:60px;top:0px;">{{ item.name }}</span>
                            <el-tag style="position:relative;left:-100px;top:-10px;"><span
                                    style="text-decoration: line-through;font-size: 18px;">Âéü‰ª∑: {{ item.unitPrice
                                    }}</span></el-tag>
                            <el-tag type="success" style="position:relative;left:-160px;top:40px;"><span
                                    style="font-size: 18px;">ÊäòÊâ£‰ª∑:
                                    {{ Number(item.unitPrice)
                                        * 0.8
                                    }}</span></el-tag>
                            <div class="bottom card-header">
                                <el-popover placement="right" width="600" trigger="click">
                                    <el-descriptions class="margin-top" title="‰∫ßÂìÅËØ¶ÁªÜ" :column="1" border>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-user"></i>
                                                ÂêçÁß∞
                                            </template>
                                            {{ marketProduces.name }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-mobile-phone"></i>
                                                ÂàÜÁ±ª
                                            </template>
                                            {{ marketProduces.category }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-location-outline"></i>
                                                ‰∫ßÂú∞
                                            </template>
                                            {{ marketProduces.origin }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                ÂïÜÂÆ∂
                                            </template>
                                            {{ marketProduces.username }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                Âçï‰ª∑
                                            </template>
                                            {{ marketProduces.unitPrice * 0.8 }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                Â∫ìÂ≠ò(kg)
                                            </template>
                                            {{ marketProduces.weight }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-tickets"></i>
                                                ÂõæÁâá
                                            </template>
                                            <img :src="marketProduces.image" alt="" style="width: 200px; height:200px;">
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                ‰∫ßÂìÅÊèèËø∞
                                            </template>
                                            {{ marketProduces.description }}
                                        </el-descriptions-item>
                                    </el-descriptions><br>
                                    <hr><br>
                                    <div style="font-size:16px;font-weight: 700;">
                                        Ë¥≠‰π∞‰∫ßÂìÅ
                                    </div><br>
                                    <div>ËØ∑ÈÄâÊã©‰∫ßÂìÅÈáçÈáè(kg)</div><br>
                                    <el-input-number v-model="weight" :precision="2" :step="1.0" :min="0.1"
                                        :max="marketProduces.weight"></el-input-number><br><br>
                                    <el-button type="primary" @click="purchasePlus" class="button">Ë¥≠‰π∞</el-button>
                                    <el-dialog title="Á°ÆËÆ§ËÆ¢Âçï" :visible.sync="dialogTableVisible3" append-to-body>

                                        <span
                                            style="font-size:22px; position:relative;left:180px;">ËØ∑ÂèäÊó∂Á°ÆËÆ§ËÆ¢ÂçïÔºå15ÂàÜÈíüÂêéÂ∞ÜËá™Âä®ÂèñÊ∂àËÆ¢Âçï</span><br><br>
                                        <span style="font-size:24px; position:relative;left:360px;">{{ minutes }}:{{
                                            seconds }}</span>
                                        <el-descriptions class="margin-top" title="ËÆ¢ÂçïËØ¶ÁªÜ" :column="1" border>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-user"></i>
                                                    ËÆ¢ÂçïÂè∑
                                                </template>
                                                {{ orders.orderNumber }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-mobile-phone"></i>
                                                    ÂïÜÂÆ∂ÂêçÁß∞
                                                </template>
                                                {{ orders.merchantName }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-location-outline"></i>
                                                    Êî∂Ë¥ß‰∫∫ÂßìÂêç
                                                </template>
                                                {{ orders.consigneeName }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    Êî∂Ë¥ßÂú∞ÂùÄ
                                                </template>
                                                {{ orders.addressBookName }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    Êî∂Ë¥ß‰∫∫ÁîµËØùÂè∑Á†Å
                                                </template>
                                                {{ orders.phoneNumber }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    ‰∫ßÂìÅÂêçÁß∞
                                                </template>
                                                {{ ordersDetails.produceName }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    ‰∫ßÂìÅÂõæÁâá
                                                </template>
                                                <img :src="ordersDetails.image" style="width:100px;height:100px;">
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    ÈáçÈáè(kg)
                                                </template>
                                                {{ ordersDetails.produceWeight }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    Âçï‰ª∑
                                                </template>
                                                {{ ordersDetails.unitPrice * 0.8 }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    ÊÄª‰ª∑
                                                </template>
                                                {{ ordersDetails.amount }}
                                            </el-descriptions-item>
                                        </el-descriptions>
                                        <span>Â§áÊ≥®</span>
                                        <el-input type="textarea" v-model="orders.remark"></el-input>
                                        <br>
                                        <el-popover placement="left" width="300" trigger="click">
                                            <div v-for="item in user.address" :key="item.id">
                                                <el-tag>Num : {{ item.number }}</el-tag><br>
                                                <hr>
                                                <span>Êî∂Ë¥ß‰∫∫ÂßìÂêç:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                    item.consigneeName }}</span><br>
                                                <hr>
                                                <span>ÁîµËØùÂè∑Á†Å:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                    item.consigneePhoneNumber }}</span><br>
                                                <hr>
                                                <span>Êî∂Ëé∑Âú∞ÂùÄ:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                    item.location }}</span>
                                                <hr>
                                                <br>

                                                <el-button type="text"
                                                    @click="updateAddress(item.id, item.location, item.consigneeName, item.consigneePhoneNumber)">ÈÄâÊã©ËØ•Âú∞ÂùÄ</el-button>
                                            </div>
                                            <el-button slot="reference" type="text" class="button">‰øÆÊîπÊî∂Ë¥ßÂú∞ÂùÄ</el-button>
                                        </el-popover>
                                        <br>
                                        <hr>
                                        <br>
                                        <el-button type="primary" class="button"
                                            @click="confirmPurchasePlus(id)">Á°ÆËÆ§Ë¥≠‰π∞</el-button>
                                        <el-button type="text" class="button" @click="cancelPurchase">ÂèñÊ∂àËÆ¢Âçï</el-button>
                                    </el-dialog>
                                    <el-button slot="reference" type="text" class="button"
                                        @click="selectById(item.id)">Êä¢Ë¥≠</el-button>
                                </el-popover>
                            </div>
                        </div>
                    </el-card>
                </template>
            </el-skeleton>
        </div>

        <!-- ‰∫ßÂìÅ‰∫§Êòì -->
        <hr style="width: 100%" class="hr">
        <span id="span3">‰∫ßÂìÅ‰∫§Êòì</span>
        <div>
            <el-row :gutter="20" style="position:relative;left:110px;top:40px;">
                <el-col :span="3"><el-input v-model="name" placeholder="ÂêçÁß∞"></el-input></el-col>
                <el-col :span="3"><el-input v-model="username" placeholder="ÂïÜÂÆ∂"></el-input></el-col>
                <!-- ‰∏ãÊãâÂàóË°® -->
                <el-col :span="3">
                    <el-select v-model="category" placeholder="ËØ∑ÈÄâÊã©ÂàÜÁ±ª">
                        <el-option label="ÂÖ®ÈÉ®" value="">
                        </el-option>
                        <el-option v-for="itme in categorys" :key="itme.id" :label="itme.name" :value="itme.id">
                        </el-option>
                    </el-select>
                </el-col>
                <!-- ÊéíÂ∫è -->
                <el-col :span="3">
                    <el-select v-model="order" placeholder="ÊéíÂ∫è">
                        <el-option label="ÈªòËÆ§ÊéíÂ∫è" value="">
                        </el-option>
                        <el-option label="‰ª∑Ê†ºÊéíÂ∫è" value="1">
                        </el-option>
                        <el-option label="ÈîÄÈáèÊéíÂ∫è" value="2">
                        </el-option>
                        <el-option label="Â∫ìÂ≠òÊéíÂ∫è" value="3">
                        </el-option>
                    </el-select>
                </el-col>
                <el-button icon="el-icon-caret-top" style="position:absolute;top:0px;left:820px;"
                    @click="sc('1')">‰ªé‰ΩéÂà∞È´ò</el-button>
                <el-button icon="el-icon-caret-bottom" style="position:absolute;top:25px;left:810px;"
                    @click="sc('2')">‰ªéÈ´òÂà∞‰Ωé</el-button>
                <!-- ÊåâÈíÆ -->
                <div style="display:inline-block;position:relative;top:0px;left:10px;">

                    <el-button type="primary" icon="el-icon-search" class="button" @click="selectAll">Êü•Êâæ</el-button>
                    <el-badge :value="shoppingCarts.length" style="margin-right: 20px;margin-left:80px;">
                        <el-button size="small" class="button goods" icon="el-icon-s-goods"
                            @click="openGoods">Ë¥≠Áâ©ËΩ¶</el-button>
                        <el-dialog title="Ë¥≠Áâ©ËΩ¶" :visible.sync="dialogTableGoods" append-to-body style="height:100%;">
                            <!-- ÂÖ®ÈÉ®ÁªìÁÆó -->
                            <el-button type="primary" class="button" @click="purchaseAll">ÂÖ®ÈÉ®ÁªìÁÆó</el-button>
                            <el-dialog title="Á°ÆËÆ§ËÆ¢Âçï" :visible.sync="dialogTableVisible2" append-to-body>
                                <span
                                    style="font-size:22px; position:relative;left:180px;">ËØ∑ÂèäÊó∂Á°ÆËÆ§ËÆ¢ÂçïÔºå15ÂàÜÈíüÂêéÂ∞ÜËá™Âä®ÂèñÊ∂àËÆ¢Âçï</span><br><br>
                                <span style="font-size:24px; position:relative;left:360px;">{{ minutes }}:{{
                                    seconds }}</span>
                                <div v-for="item in ordersDetailsShopping" :key="item.id">
                                    <el-descriptions class="margin-top" title="ËÆ¢ÂçïËØ¶ÁªÜ" :column="2" border>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                ‰∫ßÂìÅÂêçÁß∞
                                            </template>
                                            {{ item.produceName }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                ÈáçÈáè(kg)
                                            </template>
                                            {{ item.produceWeight }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                Âçï‰ª∑
                                            </template>
                                            {{ item.unitPrice }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                ÊÄª‰ª∑
                                            </template>
                                            {{ item.amount }}
                                        </el-descriptions-item>
                                        <el-descriptions-item>
                                            <template slot="label">
                                                <i class="el-icon-office-building"></i>
                                                ‰∫ßÂìÅÂõæÁâá
                                            </template>
                                            <img :src="item.image" style="width:100px;height:100px;">
                                        </el-descriptions-item>
                                    </el-descriptions>
                                    <br>
                                </div>
                                <br>
                                <hr>
                                <el-descriptions class="margin-top" title="Êî∂Ë¥ßÂú∞ÂùÄ" :column="1" border>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-location-outline"></i>
                                            Êî∂Ë¥ß‰∫∫ÂßìÂêç
                                        </template>
                                        {{ orders.consigneeName }}
                                    </el-descriptions-item>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-office-building"></i>
                                            Êî∂Ë¥ßÂú∞ÂùÄ
                                        </template>
                                        {{ orders.addressBookName }}
                                    </el-descriptions-item>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-office-building"></i>
                                            Êî∂Ë¥ß‰∫∫ÁîµËØùÂè∑Á†Å
                                        </template>
                                        {{ orders.phoneNumber }}
                                    </el-descriptions-item>
                                </el-descriptions>
                                <br>
                                <hr>
                                <el-descriptions class="margin-top" title="ÊÄªÈáëÈ¢ù" :column="1" border>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-location-outline"></i>
                                            ÊÄªÈáëÈ¢ù
                                        </template>
                                        {{ allPrice }}
                                    </el-descriptions-item>
                                </el-descriptions>
                                <br>
                                <br>
                                <span
                                    style="font-size:16px;margin-left:150px;color:rgba(0,0,0,0.9);">Ê∏©È¶®ÊèêÁ§∫:Êî∂Ëé∑Âú∞ÂùÄ‰ø°ÊÅØ‰∏∫ÈªòËÆ§Êî∂Ë¥ßÂú∞ÂùÄ‰ø°ÊÅØ,Â¶ÇÈúÄÊõ¥Êîπ,ËØ∑Âà∞‰∏™‰∫∫‰∏≠ÂøÉÊõ¥Êîπ</span>
                                <br>
                                <el-button type="primary" class="button"
                                    @click="confirmPurchaseShoppings">Á°ÆËÆ§Ë¥≠‰π∞</el-button>
                                <el-button type="text" class="button" @click="cancelPurchaseAll">‰∏ÄÈîÆÂèñÊ∂à</el-button>
                            </el-dialog>
                            <!-- Ê∏ÖÁ©∫Ë¥≠Áâ©ËΩ¶ -->
                            <el-button type="text" class="button" @click="deleteAllShopping">‰∏ÄÈîÆÊ∏ÖÁ©∫</el-button><br><br>
                            <!-- Ë¥≠Áâ©ËΩ¶ÂàóË°®Êï∞ÊçÆÂ±ïÁ§∫ -->
                            <span v-show="emptyShow" style="font-size: 28px;margin-left:150px;">Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫ÔºåÂø´ÂéªÈÄâÊã©ÂøÉ‰ª™ÁöÑ‰∫ßÂìÅÂêßÔºÅ</span>
                            <div v-for="item in shoppingCarts" :key="item.id">
                                <el-descriptions class="margin-top" title="" :column="3" border>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-user"></i>
                                            ÂïÜÂìÅÂêçÁß∞
                                        </template>
                                        {{ item.marketProducesName }}
                                    </el-descriptions-item>

                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-location-outline"></i>
                                            Âçï‰ª∑
                                        </template>
                                        {{ item.unitPrice }}
                                    </el-descriptions-item>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-office-building"></i>
                                            ÈáçÈáè
                                        </template>
                                        {{ item.weight }}
                                    </el-descriptions-item>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-office-building"></i>
                                            ÊÄª‰ª∑
                                        </template>
                                        {{ item.amount }}
                                    </el-descriptions-item>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-mobile-phone"></i>
                                            ÂõæÁâá
                                        </template>
                                        <img :src="item.image" alt="" style="width:80px;height:80px;">
                                    </el-descriptions-item>
                                    <el-descriptions-item>
                                        <template slot="label">
                                            <i class="el-icon-mobile-phone"></i>
                                            Êìç‰Ωú
                                        </template>
                                        <!-- Ë¥≠Áâ©ËΩ¶‰∫ßÂìÅÂçïÁã¨Ë¥≠‰π∞ -->
                                        <el-button type="text" @click="shoppingCartPurchase(item)">Ë¥≠‰π∞</el-button>
                                        <el-button type="text" @click="open(item.id)">Âà†Èô§</el-button>
                                        <el-dialog title="Á°ÆËÆ§ËÆ¢Âçï" :visible.sync="dialogTableVisible1" append-to-body>
                                            <span
                                                style="font-size:22px; position:relative;left:180px;">ËØ∑ÂèäÊó∂Á°ÆËÆ§ËÆ¢ÂçïÔºå15ÂàÜÈíüÂêéÂ∞ÜËá™Âä®ÂèñÊ∂àËÆ¢Âçï</span><br><br>
                                            <span style="font-size:24px; position:relative;left:360px;">{{ minutes }}:{{
                                                seconds }}</span>
                                            <el-descriptions class="margin-top" title="ËÆ¢ÂçïËØ¶ÁªÜ" :column="1" border>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-user"></i>
                                                        ËÆ¢ÂçïÂè∑
                                                    </template>
                                                    {{ orders.orderNumber }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-mobile-phone"></i>
                                                        ÂïÜÂÆ∂ÂêçÁß∞
                                                    </template>
                                                    {{ orders.merchantName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-location-outline"></i>
                                                        Êî∂Ë¥ß‰∫∫ÂßìÂêç
                                                    </template>
                                                    {{ orders.consigneeName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        Êî∂Ë¥ßÂú∞ÂùÄ
                                                    </template>
                                                    {{ orders.addressBookName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        Êî∂Ë¥ß‰∫∫ÁîµËØùÂè∑Á†Å
                                                    </template>
                                                    {{ orders.phoneNumber }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        ‰∫ßÂìÅÂêçÁß∞
                                                    </template>
                                                    {{ ordersDetails.produceName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        ÈáçÈáè(kg)
                                                    </template>
                                                    {{ ordersDetails.produceWeight }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        Âçï‰ª∑
                                                    </template>
                                                    {{ ordersDetails.unitPrice }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        ÊÄª‰ª∑
                                                    </template>
                                                    {{ ordersDetails.amount }}
                                                </el-descriptions-item>
                                            </el-descriptions>
                                            <span>Â§áÊ≥®</span>
                                            <el-input type="textarea" v-model="orders.remark"></el-input>
                                            <br>
                                            <el-popover placement="left" width="300" trigger="click">
                                                <div v-for="item in user.address" :key="item.id">
                                                    <el-tag>Num : {{ item.number }}</el-tag><br>
                                                    <hr>
                                                    <span>Êî∂Ë¥ß‰∫∫ÂßìÂêç:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                        item.consigneeName }}</span><br>
                                                    <hr>
                                                    <span>ÁîµËØùÂè∑Á†Å:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                        item.consigneePhoneNumber }}</span><br>
                                                    <hr>
                                                    <span>Êî∂Ëé∑Âú∞ÂùÄ:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                        item.location }}</span>
                                                    <hr>
                                                    <br>
                                                    <el-button type="text"
                                                        @click="updateAddress(item.id, item.location, item.consigneeName, item.consigneePhoneNumber)">ÈÄâÊã©ËØ•Âú∞ÂùÄ</el-button><br><br>
                                                </div>
                                                <el-button slot="reference" type="text"
                                                    class="button">‰øÆÊîπÊî∂Ë¥ßÂú∞ÂùÄ</el-button>
                                            </el-popover>
                                            <br>
                                            <hr>
                                            <br>
                                            <el-button type="primary" class="button"
                                                @click="confirmPurchaseShopping(id, item.id)">Á°ÆËÆ§Ë¥≠‰π∞</el-button>
                                            <el-button type="text" class="button"
                                                @click="cancelPurchase">ÂèñÊ∂àËÆ¢Âçï</el-button>
                                        </el-dialog>
                                    </el-descriptions-item>
                                </el-descriptions>
                                <br>
                                <hr>
                                <br>
                            </div>
                        </el-dialog>
                    </el-badge>
                    <!-- ‰∏äÊû∂‰∫ßÂìÅ -->
                    <el-popover placement="right" width="400" trigger="click">
                        <div class="popover">
                            <el-form :model="marketProduces" :rules="rules" ref="marketProduces" label-width="100px"
                                class="demo-ruleForm">
                                <el-form-item label="ÂêçÁß∞" prop="name">
                                    <el-input v-model="marketProduces.name"></el-input>
                                </el-form-item><br>
                                <el-form-item label="ÂàÜÁ±ª" prop="category">
                                    <el-select v-model="marketProduces.category" placeholder="ËØ∑ÈÄâÊã©ÁßçÁ±ª">
                                        <el-option v-for="item in categorys" :key="item.id" :label="item.name"
                                            :value="item.id"></el-option>
                                    </el-select>
                                </el-form-item><br>
                                <el-form-item label="‰∫ßÂú∞" prop="origin">
                                    <el-input v-model="marketProduces.origin"></el-input>
                                </el-form-item><br>
                                <el-form-item label="Áä∂ÊÄÅ" prop="status">
                                    <el-select v-model="marketProduces.status" placeholder="ËØ∑ÈÄâÊã©Áä∂ÊÄÅ">
                                        <el-option label="ÂêØÁî®" value="1"></el-option>
                                        <el-option label="Á¶ÅÁî®" value="2"></el-option>
                                    </el-select>
                                </el-form-item><br>
                                <el-form-item label="Âçï‰ª∑" prop="unitPrice">
                                    <el-input-number v-model="marketProduces.unitPrice" :precision="2" :step="1.0"
                                        :min="0.1" :max="999999"></el-input-number>
                                </el-form-item><br>
                                <el-form-item label="ÈáçÈáè(kg)" prop="weight">
                                    <el-input-number v-model="marketProduces.weight" :precision="2" :step="10.0"
                                        :min="0.1" :max="9999999"></el-input-number>
                                </el-form-item><br>
                                <el-form-item label="ÂõæÁâá">
                                    <el-upload class="avatar-uploader" action="http://localhost:8081/upload"
                                        :show-file-list="false" :on-success="handleAvatarSuccess"
                                        :before-upload="beforeAvatarUpload" style="padding:30px;">
                                        <img v-if="marketProduces.image" :src="marketProduces.image" class="avatar"
                                            style="width:200px;height: 200px;">
                                        <i v-else class="el-icon-plus avatar-uploader-icon"></i>
                                    </el-upload>
                                </el-form-item><br>
                                <el-form-item label="‰∫ßÂìÅÊèèËø∞" prop="description">
                                    <el-input type="textarea" v-model="marketProduces.description"></el-input>
                                </el-form-item><br>
                                <el-form-item>
                                    <el-button type="primary" @click="submitForm('marketProduces')"
                                        class="button">Á´ãÂç≥ÂàõÂª∫</el-button>
                                    <el-button type="text" @click="resetForm('marketProduces')">ÈáçÁΩÆ</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                        <el-button slot="reference" type="primary" icon="el-icon-plus" class="button"
                            @click="emptyForm">‰∏äÊû∂‰∫ßÂìÅ</el-button>
                    </el-popover>
                </div>

            </el-row>

            <!-- ÂàóË°®Êï∞ÊçÆ‰∏∫Á©∫Â±ïÁ§∫ -->
            <div v-if="ske">
                <el-skeleton :rows="6" animated style="position: relative;top:100px;" />
                <span style="position: relative;top:100px; font-size: larger;">Êú™Êü•ËØ¢Âà∞Á¨¶ÂêàÊù°‰ª∂ÁöÑ‰∫ßÂìÅÔºÅ</span>
                <el-skeleton :rows="6" animated style="position: relative;top:100px;" />
            </div>

            <!-- ‰∫ßÂìÅÂàóË°®Êï∞ÊçÆ -->
            <div style="position:relative; left:8px; top:80px;">

                <el-skeleton :loading="loading" animated :count="3">
                    <template>
                        <el-card :body-style="{ padding: '0px', marginBottom: '1px' }" v-for="item in lists"
                            :key="item.id" style="display:inline-block;margin:10px;width:340px;height:440px;">
                            <img :src="item.image" class="image multi-content" style="width:340px;height:340px;" />
                            <div style="padding: 14px;">
                                <el-tag style="position:relative;left:-60px;top:-15px;">ÁßçÁ±ª: {{ item.category }}</el-tag>
                                <el-tag style="position:relative;left:-120px;top:30px;" type="success">Âçï‰ª∑: {{
                                    item.unitPrice }}</el-tag>
                                <span style="position:relative;left:-50px;font-weight: 100;font-size:medium">{{
                                    item.name }}</span>
                                <div class="bottom card-header">
                                    <br>
                                    <el-popover placement="right" width="600" trigger="click">
                                        <el-descriptions class="margin-top" title="‰∫ßÂìÅËØ¶ÁªÜ" :column="1" border>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-user"></i>
                                                    ÂêçÁß∞
                                                </template>
                                                {{ marketProduces.name }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-mobile-phone"></i>
                                                    ÂàÜÁ±ª
                                                </template>
                                                {{ marketProduces.category }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-location-outline"></i>
                                                    ‰∫ßÂú∞
                                                </template>
                                                {{ marketProduces.origin }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    ÂïÜÂÆ∂
                                                </template>
                                                {{ marketProduces.username }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    Âçï‰ª∑
                                                </template>
                                                {{ marketProduces.unitPrice }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    Â∫ìÂ≠ò(kg)
                                                </template>
                                                {{ marketProduces.weight }}
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-tickets"></i>
                                                    ÂõæÁâá
                                                </template>
                                                <img :src="marketProduces.image" alt=""
                                                    style="width: 200px; height:200px;">
                                            </el-descriptions-item>
                                            <el-descriptions-item>
                                                <template slot="label">
                                                    <i class="el-icon-office-building"></i>
                                                    ‰∫ßÂìÅÊèèËø∞
                                                </template>
                                                {{ marketProduces.description }}
                                            </el-descriptions-item>
                                        </el-descriptions><br>
                                        <hr><br>
                                        <div style="font-size:16px;font-weight: 700;">
                                            Ë¥≠‰π∞‰∫ßÂìÅ
                                        </div><br>
                                        <div>ËØ∑ÈÄâÊã©‰∫ßÂìÅÈáçÈáè(kg)</div><br>
                                        <el-input-number v-model="weight" :precision="2" :step="1.0" :min="0.1"
                                            :max="marketProduces.weight"></el-input-number><br><br>
                                        <el-button type="primary" @click="purchase" class="button">Ë¥≠‰π∞</el-button>
                                        <el-dialog title="Á°ÆËÆ§ËÆ¢Âçï" :visible.sync="dialogTableVisible" append-to-body>

                                            <span
                                                style="font-size:22px; position:relative;left:180px;">ËØ∑ÂèäÊó∂Á°ÆËÆ§ËÆ¢ÂçïÔºå15ÂàÜÈíüÂêéÂ∞ÜËá™Âä®ÂèñÊ∂àËÆ¢Âçï</span><br><br>
                                            <span style="font-size:24px; position:relative;left:360px;">{{ minutes }}:{{
                                                seconds }}</span>
                                            <el-descriptions class="margin-top" title="ËÆ¢ÂçïËØ¶ÁªÜ" :column="1" border>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-user"></i>
                                                        ËÆ¢ÂçïÂè∑
                                                    </template>
                                                    {{ orders.orderNumber }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-mobile-phone"></i>
                                                        ÂïÜÂÆ∂ÂêçÁß∞
                                                    </template>
                                                    {{ orders.merchantName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-location-outline"></i>
                                                        Êî∂Ë¥ß‰∫∫ÂßìÂêç
                                                    </template>
                                                    {{ orders.consigneeName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        Êî∂Ë¥ßÂú∞ÂùÄ
                                                    </template>
                                                    {{ orders.addressBookName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        Êî∂Ë¥ß‰∫∫ÁîµËØùÂè∑Á†Å
                                                    </template>
                                                    {{ orders.phoneNumber }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        ‰∫ßÂìÅÂêçÁß∞
                                                    </template>
                                                    {{ ordersDetails.produceName }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        ‰∫ßÂìÅÂõæÁâá
                                                    </template>
                                                    <img :src="ordersDetails.image" style="width:100px;height:100px;">
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        ÈáçÈáè(kg)
                                                    </template>
                                                    {{ ordersDetails.produceWeight }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        Âçï‰ª∑
                                                    </template>
                                                    {{ ordersDetails.unitPrice }}
                                                </el-descriptions-item>
                                                <el-descriptions-item>
                                                    <template slot="label">
                                                        <i class="el-icon-office-building"></i>
                                                        ÊÄª‰ª∑
                                                    </template>
                                                    {{ ordersDetails.amount }}
                                                </el-descriptions-item>
                                            </el-descriptions>
                                            <span>Â§áÊ≥®</span>
                                            <el-input type="textarea" v-model="orders.remark"></el-input>
                                            <br>
                                            <el-popover placement="left" width="300" trigger="click">
                                                <div v-for="item in user.address" :key="item.id">
                                                    <el-tag>Num : {{ item.number }}</el-tag><br>
                                                    <hr>
                                                    <span>Êî∂Ë¥ß‰∫∫ÂßìÂêç:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                        item.consigneeName }}</span><br>
                                                    <hr>
                                                    <span>ÁîµËØùÂè∑Á†Å:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                        item.consigneePhoneNumber }}</span><br>
                                                    <hr>
                                                    <span>Êî∂Ëé∑Âú∞ÂùÄ:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{
                                                        item.location }}</span>
                                                    <hr>
                                                    <br>

                                                    <el-button type="text"
                                                        @click="updateAddress(item.id, item.location, item.consigneeName, item.consigneePhoneNumber)">ÈÄâÊã©ËØ•Âú∞ÂùÄ</el-button>
                                                </div>
                                                <el-button slot="reference" type="text"
                                                    class="button">‰øÆÊîπÊî∂Ë¥ßÂú∞ÂùÄ</el-button>
                                            </el-popover>
                                            <br>
                                            <hr>
                                            <br>
                                            <el-button type="primary" class="button"
                                                @click="confirmPurchase(id)">Á°ÆËÆ§Ë¥≠‰π∞</el-button>
                                            <el-button type="text" class="button"
                                                @click="cancelPurchase">ÂèñÊ∂àËÆ¢Âçï</el-button>
                                        </el-dialog>
                                        <el-button type="primary" class="button"
                                            @click="addShoppingCart">Âä†ÂÖ•Ë¥≠Áâ©ËΩ¶</el-button>
                                        <el-button slot="reference" type="text" class="button"
                                            @click="selectById(item.id)">Êü•ÁúãËØ¶ÁªÜ</el-button>
                                    </el-popover>
                                </div>
                            </div>
                        </el-card>
                    </template>
                </el-skeleton>

            </div>

        </div>
    </div>

</template>

<script>
import homeTop from '@/components/homeTop.vue';
import * as echarts from 'echarts';
import { queryCategoryUser } from '@/api/category'
import {
    createMarketProduces, queryAll, getByIdMarketProducesUser,
    createOrders, createOrdersDetails,
    updateUserOrders, getOrdersByIdUser, updateUserOrdersConfirm,
    updateUserOrdersCancel, queryProducesPlus, updateUserOrdersConfirmPlus
} from '@/api/marketProduces';

import { createShoppingCart, queryShoppingCart, deleteShoppingCart } from '@/api/shoppingCart'

import { queryCategory } from '@/api/charts';

import { mapState } from 'vuex';

export default {
    name: 'transMarket',
    components: {
        homeTop
    },
    computed: mapState([
        'user'
    ]),

    data() {

        return {

            //ÊÄª‰ª∑
            allPrice: '',
            //Ë¥≠Áâ©ËΩ¶
            shoppingCart: {
                id: '',
                userId: '',
                merchantName: '',
                marketProducesId: '',
                marketProducesName: '',
                marketProducesCategory: '',
                unitPrice: '',
                weight: '',
                image: '',
                amount: '',
                remark: '',
                createTime: '',
                updateTime: ''
            },

            emptyShow: false,

            shoppingCarts: [],

            dialogTableGoods: false,

            dialogTableVisible: false,

            dialogTableVisible1: false,

            dialogTableVisible2: false,

            dialogTableVisible3: false,

            weight: '',

            ske: true,

            loading: true,

            lists: [],

            //Áâπ‰ª∑‰∫ßÂìÅ
            listsPlus: [],

            category: '',
            categorys: '',

            //‰∏äÊû∂‰∫ßÂìÅ
            marketProduces: {
                id: '',
                name: '',
                category: '',
                origin: '',
                image: '',
                status: '',
                weight: '',
                unitPrice: '',
                description: '',
                userId: '',
                username: '',
                createTime: ''
            },

            //ËÆ¢Âçï
            orders: {
                id: '',
                orderNumber: '',
                userId: '',
                username: '',
                merchantId: '',
                merchantName: '',
                addressBookId: '',
                consigneeName: '',
                addressBookName: '',
                phoneNumber: '',
                status: '',
                completeTime: '',
                cancelTime: '',
                cancelReason: '',
                amount: '',
                remark: '',
                createTime: '',
                updateTime: '',
            },

            //ËÆ¢ÂçïÊòéÁªÜ
            ordersDetails: {
                id: '',
                ordersId: '',
                ordersNumber: '',
                produceName: '',
                image: '',
                produceCategory: '',
                produceWeight: '',
                unitPrice: '',
                createTime: '',
                updateTime: ''
            },

            //Ë¥≠Áâ©ËΩ¶Â§öËÆ¢Âçï
            ordersShopping: [],

            //Ë¥≠Áâ©ËΩ¶Â§öËÆ¢ÂçïÊòéÁªÜ
            ordersDetailsShopping: [],

            //Êï∞ÊçÆÊ†°È™å
            rules: {
                name: [
                    { required: true, message: '‰∫ßÂìÅÂêçÁß∞', trigger: 'blur' },
                    { min: 1, max: 12, message: 'ÈïøÂ∫¶Âú® 1 Âà∞ 12 ‰∏™Â≠óÁ¨¶', trigger: 'blur' }
                ],
                origin: [
                    { required: true, message: 'ËØ∑ËæìÂÖ•‰∫ßÂú∞', trigger: 'blur' },
                    { min: 1, max: 20, message: 'ÈïøÂ∫¶Âú® 1 Âà∞ 20 ‰∏™Â≠óÁ¨¶', trigger: 'blur' }
                ],
                description: [
                    { required: true, message: 'ËØ∑ËæìÂÖ•‰∫ßÂìÅÊèèËø∞', trigger: 'blur' },
                    { min: 1, max: 300, message: 'ÈïøÂ∫¶Âú® 1 Âà∞ 300 ‰∏™Â≠óÁ¨¶', trigger: 'blur' }
                ],
            },

            //‰øÆÊîπËÆ¢Âçï
            updateOrders: {
                id: '',
                addressBookId: '',
                consigneeName: '',
                consigneePhoneNumber: '',
                addressBookName: '',
                remark: '',
                marketProducesId: ''
            },

            name: '',
            username: '',
            order: '',
            orderKind: '1',

            id: '',

            address: {
                consigneeName: '',
                consigneePhoneNumber: '',
                location: ''
            },

            //ÂÄíËÆ°Êó∂
            minutes: 0,
            seconds: 0,
            timer: null,

            //ÂÄíËÆ°Êó∂plus1
            minutesPlus1: 0,
            secondsPlus1: 0,
            timerPlus1: null,

            i1: null,
        }
    },

    mounted() {

        queryProducesPlus().then(res => {
            this.listsPlus = res.data.list
            //ÂºÄÂêØËÆ¢ÂçïÁ°ÆËÆ§ÂÄíËÆ°Êó∂
            const totalMilliseconds = res.data.date;
            if (res.data.date < 0) {
                this.initCountdownPlus1(60 * 1000);
            }
            this.initCountdownPlus1(totalMilliseconds);
            this.startCountdownPlus1();
        })

        this.getCategory()
        this.selectAll()
        this.queryShopping()

        if (this.user.address.length != null) {
            this.address = this.user.address[0]
        }

        const myChart = echarts.init(document.getElementById('main'));

        var categoryList = []

        var amountList = []



        var option = {
            title: {
                text: 'ÂÜú‰∫ßÂìÅÂàÜÁ±ªÊÄªÈîÄÂîÆÈ¢ùÊéíÂêçTOP10'
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            legend: {},
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                boundaryGap: [0, 0.01]
            },
            yAxis: {
                type: 'category',
                data: categoryList
            },
            series: [
                {
                    name: 'ÂÜú‰∫ßÂìÅÂàÜÁ±ªÊÄªÈîÄÂîÆÈ¢ùÊéíÂêçTOP10',
                    type: 'bar',
                    data: amountList
                },
            ]
        };

        queryCategory().then(
            res => {
                for (const item of res.data.category) {
                    categoryList.push(item);
                }
                for (const item of res.data.amount) {
                    amountList.push(item);
                }
                // Êõ¥Êñ∞ÂõæË°®ÈÄâÈ°π‰∏≠ÁöÑÊï∞ÊçÆ
                option.yAxis.data = categoryList;
                option.series[0].data = amountList;
                myChart.setOption(option);
            }
        );

        //Êõ¥Êñ∞ÊéíÂêç
        function update() {
            // ÂÖàÊ∏ÖÁ©∫Êï∞ÁªÑ
            categoryList = [];
            amountList = [];
            queryCategory().then(
                res => {
                    for (const item of res.data.category) {
                        categoryList.push(item);
                    }
                    for (const item of res.data.amount) {
                        amountList.push(item);
                    }
                    // Êõ¥Êñ∞ÂõæË°®ÈÄâÈ°π‰∏≠ÁöÑÊï∞ÊçÆ
                    option.yAxis.data = categoryList;
                    option.series[0].data = amountList;
                    myChart.setOption(option);
                }
            );
        }

        this.i1 = setInterval(function () {
            update();
        }, 10000);

        this.loading = false
    },

    beforeDestroy() {
        if (this.timer) {
            clearInterval(this.timer);
        }
        if (this.timerPlus1) {
            clearInterval(this.timerPlus1);
        }
        if (this.i1) {
            clearInterval(this.i1);
        }
    },

    methods: {

        confirmPurchasePlus(id) {
            this.updateOrders.id = this.orders.id
            this.updateOrders.marketProducesId = id
            if (this.orders.remark != '' && this.orders != null) {
                this.updateOrders.remark = this.orders.remark
            }
            updateUserOrdersConfirmPlus(this.updateOrders).then(res => {

                if (res.code == 1) {
                    this.dialogTableVisible3 = false
                    queryProducesPlus().then(res => {
                        this.listsPlus = res.data.list;
                        // ÂºÄÂêØËÆ¢ÂçïÁ°ÆËÆ§ÂÄíËÆ°Êó∂
                        const totalMilliseconds = res.data.date;
                        this.initCountdownPlus1(totalMilliseconds);
                        this.isRequestPending = false;
                        this.startCountdownPlus1();
                    });

                    this.$message({
                        showClose: true,
                        message: 'Ë¥≠‰π∞ÊàêÂäü',
                        type: 'success'
                    });
                }
            })
        },

        //Ë¥≠‰π∞‰∫ßÂìÅÔºåÁîüÊàêËÆ¢ÂçïÂèäËÆ¢ÂçïÊòéÁªÜË°®
        purchasePlus() {
            if (this.user.address.length == 0) {
                this.$message({
                    showClose: true,
                    message: 'ÊÇ®ËøòÊú™Ê∑ªÂä†Êî∂Ë¥ßÂú∞ÂùÄÔºåËØ∑Âú®‰∏™‰∫∫‰∏≠ÂøÉÊ∑ªÂä†ÂêéË¥≠‰π∞',
                    type: 'error'
                });
                return
            }
            this.dialogTableVisible3 = true

            const order = {
                userId: this.user.id,
                username: this.user.username,
                merchantName: this.marketProduces.username,
                merchantId: this.marketProduces.id
            }

            createOrders(order).then(res => {
                this.orders = res.data
                const orderDetails = {
                    produceName: this.marketProduces.name,
                    produceCategory: this.marketProduces.category,
                    unitPrice: this.marketProduces.unitPrice,
                    ordersId: res.data.id,
                    weight: this.weight
                }

                createOrdersDetails(orderDetails).then(res => {
                    this.ordersDetails = res.data
                })
            })

            //ÂºÄÂêØËÆ¢ÂçïÁ°ÆËÆ§ÂÄíËÆ°Êó∂
            const totalMilliseconds = 900 * 1000;
            this.initCountdown(totalMilliseconds);
            this.startCountdown();
        },

        //ÂàùÂßãÂåñÁßíÊùÄ‰∫ßÂìÅËÆ°Êó∂Âô®
        initCountdownPlus1(totalMilliseconds) {
            this.minutesPlus1 = Math.floor(totalMilliseconds / (1000 * 60));
            const remainingAfterMinutes = totalMilliseconds % (1000 * 60);
            this.secondsPlus1 = Math.floor(remainingAfterMinutes / 1000);
        },

        //ÂºÄÂêØÁßíÊùÄ‰∫ßÂìÅËÆ°Êó∂Âô®
        startCountdownPlus1() {

            clearInterval(this.timerPlus1);
            const updateCountdown = () => {

                if (this.secondsPlus1 > 0) {
                    this.secondsPlus1--;
                } else {
                    if (this.minutesPlus1 > 0) {
                        this.minutesPlus1--;
                        this.secondsPlus1 = 59;
                    } else {

                        if (this.secondsPlus1 == 0) {
                            clearInterval(this.timerPlus1);
                            this.$notify({
                                title: 'ÁßíÊùÄÊèêÈÜí',
                                message: 'Êñ∞‰∏ÄËΩÆÊä¢Ë¥≠ÂºÄÂßã',
                                type: 'success'
                            });
                            queryProducesPlus().then(res => {
                                this.listsPlus = res.data.list;
                                // ÂºÄÂêØËÆ¢ÂçïÁ°ÆËÆ§ÂÄíËÆ°Êó∂
                                const totalMilliseconds = res.data.date;
                                if (res.data.date == null || res.data.date < 0) {
                                    this.initCountdownPlus1(60 * 1000);
                                } else {
                                    this.initCountdownPlus1(totalMilliseconds);
                                }
                                this.isRequestPending = false;
                                this.startCountdownPlus1();
                            });
                        }
                    }
                }
            };

            this.timerPlus1 = setInterval(updateCountdown, 1000);
        },

        //ÂàùÂßãÂåñËÆ¢ÂçïËÆ°Êó∂Âô®
        initCountdown(totalMilliseconds) {
            this.minutes = Math.floor(totalMilliseconds / (1000 * 60));
            const remainingAfterMinutes = totalMilliseconds % (1000 * 60);
            this.seconds = Math.floor(remainingAfterMinutes / 1000);
        },

        //ÂºÄÂêØËÆ¢ÂçïËÆ°Êó∂Âô®
        startCountdown() {
            clearInterval(this.timer);
            const updateCountdown = () => {
                if (this.seconds > 0) {
                    this.seconds--;
                } else {
                    if (this.minutes > 0) {
                        this.minutes--;
                        this.seconds = 59;
                    } else {
                        clearInterval(this.timer);
                    }
                }
            };
            this.timer = setInterval(updateCountdown, 1000); // ÊØèÁßíÊõ¥Êñ∞‰∏ÄÊ¨°Ôºå‰∏éÁ≥ªÁªüÁßíÊï∞Êõ¥Êñ∞È¢ëÁéá‰∏ÄËá¥
        },

        //Ë¥≠Áâ©ËΩ¶‰∏ÄÈîÆÂèñÊ∂àË¥≠‰π∞
        cancelPurchaseAll() {
            for (const item of this.ordersShopping) {
                this.updateOrders.id = item.id
                updateUserOrdersCancel(this.updateOrders).then(
                    res => {
                        if (res.code == 1) {
                            this.dialogTableVisible = false
                            this.dialogTableVisible1 = false

                        }
                    }
                )
            }
            this.dialogTableVisible2 = false;
            this.$message({
                showClose: true,
                message: 'ÂèñÊ∂àÊàêÂäü',
                type: 'success'
            });
        },

        //‰∏ÄÈîÆÁªìÁÆóÁ°ÆËÆ§Ë¥≠‰π∞
        confirmPurchaseShoppings() {
            //ÈÅçÂéÜË¥≠Áâ©ËΩ¶ËÆ¢ÂçïÂàóË°®ÊâπÈáè‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅ
            //ÂÆö‰πâÊï∞ÁªÑÁî®Êù•ÊûÑÈÄ†ÊâÄÈúÄÂèÇÊï∞
            var params = []
            for (let i = 0; i < this.ordersShopping.length; i++) {

                let param = {
                    ordersId: '',
                    marketProducesId: '',
                    shoppingId: ''
                }
                param.ordersId = this.ordersShopping[i].id
                param.marketProducesId = this.shoppingCarts[i].marketProducesId
                param.shoppingId = this.shoppingCarts[i].id

                params.push(param)
            }

            for (const item of params) {

                const i = {
                    id: '',
                    addressBookId: '',
                    consigneeName: '',
                    consigneePhoneNumber: '',
                    addressBookName: '',
                    remark: '',
                    marketProducesId: ''
                }

                i.id = item.ordersId
                i.marketProducesId = item.marketProducesId

                updateUserOrdersConfirm(i).then(res => {
                    if (res.code == 1) {
                        this.selectAll()
                    }
                })
            }

            //Ê∏ÖÁ©∫Ë¥≠Áâ©ËΩ¶
            for (var i = 0; i < this.shoppingCarts.length; i++) {
                this.deleteShopping(this.shoppingCarts[i].id)
            }

            this.dialogTableVisible2 = false;
            this.ordersShopping = []
            this.ordersDetailsShopping = []
            this.$message({
                showClose: true,
                message: 'Ë¥≠‰π∞ÊàêÂäü',
                type: 'success'
            });

        },

        //‰∏ÄÈîÆÁªìÁÆó
        purchaseAll() {

            if (this.user.address.length == 0) {
                this.$message({
                    showClose: true,
                    message: 'ÊÇ®ËøòÊú™Ê∑ªÂä†Êî∂Ë¥ßÂú∞ÂùÄÔºåËØ∑Âú®‰∏™‰∫∫‰∏≠ÂøÉÊ∑ªÂä†ÂêéË¥≠‰π∞',
                    type: 'error'
                });
                return
            }

            this.ordersShopping = []
            this.ordersDetailsShopping = []
            this.dialogTableVisible2 = true
            this.allPrice = ''

            // Ëé∑ÂèñË¥≠Áâ©ËΩ¶‰∏≠ÁöÑÊâÄÊúâÊï∞ÊçÆ
            if (this.shoppingCarts.length != 0) {
                // ÈÅçÂéÜË¥≠Áâ©ËΩ¶Êï∞ÊçÆÔºå‰æùÊ¨°ÁîüÊàêËÆ¢ÂçïÂíåËÆ¢ÂçïÊòéÁªÜ
                for (const item of this.shoppingCarts) {

                    const order = {
                        userId: this.user.id,
                        username: this.user.username,
                        merchantName: item.merchantName,
                        merchantId: item.marketProducesId
                    };

                    createOrders(order).then(res => {
                        this.orders = res.data;
                        // Â∞ÜÁîüÊàêÁöÑËÆ¢ÂçïÂä†ÂÖ•Âà∞Ë¥≠Áâ©ËΩ¶ËÆ¢ÂçïÂàóË°®‰∏≠
                        this.ordersShopping.push(this.orders)

                        const orderDetails = {
                            produceName: item.marketProducesName,
                            produceCategory: item.marketProducesCategory,
                            unitPrice: item.unitPrice,
                            ordersId: res.data.id,
                            weight: item.weight
                        };

                        createOrdersDetails(orderDetails).then(res => {
                            this.ordersDetails = res.data;
                            // Â∞ÜËÆ¢ÂçïÊòéÁªÜÂä†ÂÖ•Ë¥≠Áâ©ËΩ¶ËÆ¢ÂçïÊòéÁªÜÂàóË°®‰∏≠
                            this.ordersDetailsShopping.push(this.ordersDetails)

                            this.allPrice = Number(this.allPrice) + Number(this.ordersDetails.amount)
                        });
                    });

                }

                //ÂºÄÂêØËÆ¢ÂçïÁ°ÆËÆ§ÂÄíËÆ°Êó∂
                const totalMilliseconds = 900 * 1000;
                this.initCountdown(totalMilliseconds);
                this.startCountdown();

            } else {
                this.dialogTableVisible2 = false;
                this.$message({
                    type: 'info',
                    message: 'Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫ÔºÅÊó†Ê≥ïÁªìÁÆó'
                });
            }
        },

        //Ë¥≠Áâ©ËΩ¶Ë¥≠‰π∞
        shoppingCartPurchase(item) {
            if (this.user.address.length == 0) {
                this.$message({
                    showClose: true,
                    message: 'ÊÇ®ËøòÊú™Ê∑ªÂä†Êî∂Ë¥ßÂú∞ÂùÄÔºåËØ∑Âú®‰∏™‰∫∫‰∏≠ÂøÉÊ∑ªÂä†ÂêéË¥≠‰π∞',
                    type: 'error'
                });
                return
            }

            //ÂàõÂª∫ËÆ¢Âçï
            this.dialogTableVisible1 = true

            const order = {
                userId: this.user.id,
                username: this.user.username,
                merchantName: item.merchantName,
                merchantId: this.marketProduces.id
            }

            createOrders(order).then(res => {
                this.orders = res.data

                const orderDetails = {
                    produceName: item.marketProducesName,
                    produceCategory: item.marketProducesCategory,
                    unitPrice: item.unitPrice,
                    ordersId: res.data.id,
                    weight: item.weight
                }

                createOrdersDetails(orderDetails).then(res => {
                    this.ordersDetails = res.data
                })

                this.id = item.marketProducesId
            })

            //ÂºÄÂêØËÆ¢ÂçïÁ°ÆËÆ§ÂÄíËÆ°Êó∂
            const totalMilliseconds = 900 * 1000;
            this.initCountdown(totalMilliseconds);
            this.startCountdown();
        },

        //Ë¥≠Áâ©ËΩ¶Á°ÆËÆ§Ë¥≠‰π∞
        confirmPurchaseShopping(id, shoppingId) {
            this.updateOrders.id = this.orders.id
            this.updateOrders.marketProducesId = id
            if (this.orders.remark != '' && this.orders != null) {
                this.updateOrders.remark = this.orders.remark
            }
            updateUserOrdersConfirm(this.updateOrders).then(res => {
                if (res.code == 1) {
                    this.dialogTableVisible1 = false
                    this.selectAll()
                    //Âà†Èô§Ë¥≠Áâ©ËΩ¶Êï∞ÊçÆ
                    this.deleteShopping(shoppingId)

                    this.$message({
                        showClose: true,
                        message: 'Ë¥≠‰π∞ÊàêÂäü',
                        type: 'success'
                    });
                }
            })
        },

        //Âà†Èô§Ë¥≠Áâ©ËΩ¶Êï∞ÊçÆ
        deleteShopping(shoppingId) {
            deleteShoppingCart(shoppingId).then(res => {
                if (res.code == 1) {
                    //Êü•ËØ¢Êü•ËØ¢Ë¥≠Áâ©ËΩ¶
                    this.queryShopping()
                }
            })
        },

        //Ê∏ÖÁ©∫Ë¥≠Áâ©ËΩ¶
        deleteAllShopping() {
            if (this.shoppingCarts.length != 0) {

                this.$confirm('Ê≠§Êìç‰ΩúÂ∞ÜÊ∞∏‰πÖÊ∏ÖÁ©∫Ë¥≠Áâ©ËΩ¶, ÊòØÂê¶ÁªßÁª≠?', 'ÊèêÁ§∫', {
                    confirmButtonText: 'Á°ÆÂÆö',
                    cancelButtonText: 'ÂèñÊ∂à',
                    type: 'warning'
                }).then(() => {
                    for (var i = 0; i < this.shoppingCarts.length; i++) {
                        this.deleteShopping(this.shoppingCarts[i].id)
                    }
                    this.$message({
                        type: 'success',
                        message: 'Âà†Èô§ÊàêÂäü!'
                    });

                }).catch(() => {
                    this.$message({
                        type: 'info',
                        message: 'Â∑≤ÂèñÊ∂àÂà†Èô§'
                    });
                });

            } else {
                this.$message({
                    type: 'info',
                    message: 'Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫ÔºÅÊó†Ê≥ïÊ∏ÖÁ©∫'
                });
            }

        },

        open(id) {
            this.$confirm('Ê≠§Êìç‰ΩúÂ∞ÜÊ∞∏‰πÖÂà†Èô§ËØ•‰∫ßÂìÅ, ÊòØÂê¶ÁªßÁª≠?', 'ÊèêÁ§∫', {
                confirmButtonText: 'Á°ÆÂÆö',
                cancelButtonText: 'ÂèñÊ∂à',
                type: 'warning'
            }).then(() => {
                this.deleteShopping(id)

                this.$message({
                    type: 'success',
                    message: 'Âà†Èô§ÊàêÂäü!'
                });

            }).catch(() => {
                this.$message({
                    type: 'info',
                    message: 'Â∑≤ÂèñÊ∂àÂà†Èô§'
                });
            });
        },

        //ÊâìÂºÄË¥≠Áâ©ËΩ¶
        openGoods() {
            this.dialogTableGoods = true
            this.queryShopping()
        },

        //Êü•ËØ¢Áî®Êà∑Ë¥≠Áâ©ËΩ¶
        queryShopping() {
            //Ëé∑ÂèñËØ•Áî®Êà∑ÁöÑË¥≠Áâ©ËΩ¶Êï∞ÊçÆ
            queryShoppingCart(this.user.id).then(
                res => {
                    if (res) {
                        this.shoppingCarts = res.data
                        if (this.shoppingCarts.length == 0) {
                            this.emptyShow = true
                        } else {
                            this.emptyShow = false
                        }
                    } else {
                        //
                    }
                }
            )
        },

        //Ê∑ªÂä†Âà∞Ë¥≠Áâ©ËΩ¶
        addShoppingCart() {
            console.log("Ê∑ªÂä†Âà∞Ë¥≠Áâ©ËΩ¶");
            //ÊûÑÈÄ†ÂèÇÊï∞
            this.shoppingCart.userId = this.user.id
            this.shoppingCart.merchantName = this.marketProduces.username
            this.shoppingCart.marketProducesId = this.marketProduces.id
            this.shoppingCart.marketProducesName = this.marketProduces.name
            this.shoppingCart.marketProducesCategory = this.marketProduces.category
            this.shoppingCart.unitPrice = this.marketProduces.unitPrice
            this.shoppingCart.weight = this.weight
            this.shoppingCart.image = this.marketProduces.image

            createShoppingCart(this.shoppingCart).then(
                response => {
                    //Â§ÑÁêÜÂìçÂ∫îÁªìÊûú
                    if (response.code === 1) {
                        this.weight = 0.1
                        this.selectAll()
                        this.queryShopping()
                        this.$message({
                            showClose: true,
                            message: 'Ê∑ªÂä†ÊàêÂäü',
                            type: 'success'
                        });

                    } else if (response.code === 0) {
                        this.$message({
                            showClose: true,
                            message: response.msg,
                            type: 'error'
                        });
                    }
                }
            )
        },

        //Ë¥≠‰π∞‰∫ßÂìÅÔºåÁîüÊàêËÆ¢ÂçïÂèäËÆ¢ÂçïÊòéÁªÜË°®
        purchase() {
            if (this.user.address.length == 0) {
                this.$message({
                    showClose: true,
                    message: 'ÊÇ®ËøòÊú™Ê∑ªÂä†Êî∂Ë¥ßÂú∞ÂùÄÔºåËØ∑Âú®‰∏™‰∫∫‰∏≠ÂøÉÊ∑ªÂä†ÂêéË¥≠‰π∞',
                    type: 'error'
                });
                return
            }
            this.dialogTableVisible = true

            const order = {
                userId: this.user.id,
                username: this.user.username,
                merchantName: this.marketProduces.username,
                merchantId: this.marketProduces.id
            }

            createOrders(order).then(res => {
                this.orders = res.data
                const orderDetails = {
                    produceName: this.marketProduces.name,
                    produceCategory: this.marketProduces.category,
                    unitPrice: this.marketProduces.unitPrice,
                    ordersId: res.data.id,
                    weight: this.weight
                }

                createOrdersDetails(orderDetails).then(res => {
                    this.ordersDetails = res.data
                })
            })

            //ÂºÄÂêØËÆ¢ÂçïÁ°ÆËÆ§ÂÄíËÆ°Êó∂
            const totalMilliseconds = 900 * 1000;
            this.initCountdown(totalMilliseconds);
            this.startCountdown();
        },

        //‰øÆÊîπÊî∂Ë¥ßÂú∞ÂùÄ
        updateAddress(addressBookId, addressBookName, consigneeName, consigneePhoneNumber) {
            //ÂáÜÂ§áÊï∞ÊçÆ
            this.updateOrders.id = this.orders.id
            this.updateOrders.addressBookId = addressBookId
            this.updateOrders.addressBookName = addressBookName
            this.updateOrders.consigneeName = consigneeName
            this.updateOrders.consigneePhoneNumber = consigneePhoneNumber

            updateUserOrders(this.updateOrders).then(res => {
                if (res.code == 1) {
                    this.getOrders(this.orders.id)
                    this.$message({
                        showClose: true,
                        message: 'Êî∂Ë¥ßÂú∞ÂùÄ‰øÆÊîπÊàêÂäü',
                        type: 'success'
                    });
                }
            })
        },

        //Ê†πÊçÆidÊü•ËØ¢ËÆ¢Âçï
        getOrders(id) {
            getOrdersByIdUser(id).then(
                data => {
                    this.orders = data.data
                }
            )
        },

        //Á°ÆËÆ§Ë¥≠‰π∞
        confirmPurchase(id) {
            this.updateOrders.id = this.orders.id
            this.updateOrders.marketProducesId = id
            if (this.orders.remark != '' && this.orders != null) {
                this.updateOrders.remark = this.orders.remark
            }
            updateUserOrdersConfirm(this.updateOrders).then(res => {
                if (res.code == 1) {
                    this.dialogTableVisible = false
                    this.selectAll()

                    this.$message({
                        showClose: true,
                        message: 'Ë¥≠‰π∞ÊàêÂäü',
                        type: 'success'
                    });
                }
            })
        },

        //ÂèñÊ∂àË¥≠‰π∞
        cancelPurchase() {
            this.updateOrders.id = this.orders.id
            updateUserOrdersCancel(this.updateOrders).then(
                res => {
                    if (res.code == 1) {

                        if (this.dialogTableVisible == true) {
                            this.dialogTableVisible = false
                        }

                        if (this.dialogTableVisible1 == true) {
                            this.dialogTableVisible1 = false
                        }

                        if (this.dialogTableVisible3 == true) {
                            this.dialogTableVisible3 = false
                        }

                        this.$message({
                            showClose: true,
                            message: 'ÂèñÊ∂àÊàêÂäü',
                            type: 'success'
                        });
                    }
                }
            )
        },

        //Ê∏ÖÁ©∫Ë°®Âçï
        emptyForm() {
            this.marketProduces.id = ''
            this.marketProduces.name = ''
            this.marketProduces.origin = ''
            this.marketProduces.category = ''
            this.marketProduces.status = ''
            this.marketProduces.image = ''
            this.marketProduces.description = ''
            this.marketProduces.unitPrice = ''
            this.marketProduces.userId = ''
            this.marketProduces.username = ''
            this.marketProduces.createTime = ''
            this.marketProduces.weight = ''
        },

        //ÂçáÂ∫èÈôçÂ∫è
        sc(kind) {
            this.orderKind = kind;
            this.selectAll();
        },

        //Êü•ËØ¢‰∏äÊû∂‰∫ßÂìÅ
        selectAll() {
            const condition = {
                "name": this.name,
                "username": this.username,
                "category": this.category,
                "order": this.order,
                "orderKind": this.orderKind
            }
            queryAll(condition)
                .then(response => {
                    this.lists = response.data
                    if (this.lists.length == 0) {
                        this.ske = true
                    } else {
                        this.ske = false
                    }

                })
                .catch(error => {
                    console.error('Error:', error);
                });
        },

        //Ê†πÊçÆidÊü•ËØ¢‰∏äÊû∂‰∫ßÂìÅ
        selectById(id) {
            getByIdMarketProducesUser(id).then(
                data => {
                    this.weight = ''
                    this.id = id
                    this.marketProduces = data.data
                }
            )
        },

        //Ê∑ªÂä†‰∫ßÂìÅ
        submitForm(formName) {
            this.$refs[formName].validate((valid) => {
                if (valid) {
                    this.marketProduces.userId = localStorage.getItem("id")
                    createMarketProduces(this.marketProduces).then(
                        response => {
                            //Â§ÑÁêÜÂìçÂ∫îÁªìÊûú
                            if (response.code === 1) {
                                this.selectAll()
                                this.$message({
                                    showClose: true,
                                    message: 'Ê∑ªÂä†ÊàêÂäü',
                                    type: 'success'
                                });
                            } else if (response.code === 0) {
                                this.$message({
                                    showClose: true,
                                    message: response.msg,
                                    type: 'error'
                                });
                            }
                        }
                    )
                } else {
                    console.log('error submit!!');
                    return false;
                }
            });
        },

        //ÈáçÁΩÆË°®Âçï
        resetForm(formName) {
            this.$refs[formName].resetFields();
        },

        //Êü•ËØ¢ÂàÜÁ±ª
        getCategory() {
            queryCategoryUser().then(
                response => {
                    //Â§ÑÁêÜÂìçÂ∫îÁªìÊûú
                    if (response.code === 1) {
                        this.categorys = response.data
                    } else if (response.code === 0) {
                        this.$message({
                            showClose: true,
                            message: 'Êü•ËØ¢Â§±Ë¥•',
                            type: 'error'
                        });
                    }
                }
            )
        },

        scrollToDiv(id) {
            const element = document.getElementById(id);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        },

        handleAvatarSuccess(res) {
            this.marketProduces.image = res.data;
        },

        //‰∏ä‰º†ÂõæÁâáÊó∂Ê†°È™å
        beforeAvatarUpload(file) {
            const isLt2M = file.size / 1024 / 1024 < 2;

            if (!isLt2M) {
                this.$message.error('‰∏ä‰º†Â§¥ÂÉèÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá 2MB!');
            }
            return isLt2M;
        }
    }
}
</script>

<style scoped>
.producesPlus {
    transition: all 1s ease;
}

.goods {
    font-size: 18px;
    background-color: aliceblue;
}

.button {
    margin-right: 5px;
    width: 90px;
    height: 40px;
}

.hr {
    margin-top: 80px;
    margin-bottom: 20px;
}

#top10,
#span2,
#span3 {
    font-size: 40px;
    background-color: rgb(200, 255, 237);
    box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    width: 200px;
    height: 50px;
    padding-left: 20px;
    padding-right: 20px;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

.aside button {
    border: none;
    width: 20px;
    height: 180px;
    font-size: 20px;
    font-weight: 100;
    background-color: rgba(12, 13, 12, 0.1);
    border-radius: 10px;
    transition: all 0.9s ease;
}

.aside button:hover {
    background-color: rgba(12, 13, 12, 0.2);
}
</style>